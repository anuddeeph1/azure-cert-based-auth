#!/bin/bash
#############################################
# BACKUP: Amazon Linux 2 Bootstrap Script
# NOT compatible with EKS 1.33+ which requires
# AL2023 and nodeadm
#############################################
# This file is kept for reference only.
# EKS 1.33 requires AL2023 AMI with nodeadm.
#############################################

set -x
set -o xtrace
exec > >(tee /var/log/user-data.log|logger -t user-data -s 2>/dev/console) 2>&1

# Download and run bootstrap script from S3 (if using custom bootstrap)
# aws s3 cp s3://${s3_bucket_name}/eks-bootstrap-amzn2-v2.bash .
# chmod 755 eks-bootstrap-amzn2-v2.bash
# sh eks-bootstrap-amzn2-v2.bash ${clusterName}

# Set proxy variables if needed
set -a
source /etc/environment

# Run the standard EKS bootstrap script
/etc/eks/bootstrap.sh ${clusterName}

